{"version":3,"file":"utils.js","sources":["../utils.ts"],"sourcesContent":["export {\n  isHTMLElement,\n  convertDashToCamel,\n  convertCamelToDash,\n  coupleSettersAndGettersToAttributes,\n  makeElementEditableSanely,\n  findElementInEventPath,\n  changeCss,\n  loadCss,\n}\n\nfunction isHTMLElement(element: unknown): element is HTMLElement {\n  return element instanceof HTMLElement\n}\n\nfunction convertDashToCamel(str: string) {\n  return str.replace(/-([a-z])/g, function(g: string) {\n    return g[1].toUpperCase()\n  })\n}\n\nfunction convertCamelToDash(str: string) {\n  return str.replace(/([a-zA-Z])(?=[A-Z])/g, \"$1-\").toLowerCase()\n}\n\nfunction coupleSettersAndGettersToAttributes(\n  thisObj: HTMLElement,\n  camelCasePropsAsStrings: string[]\n) {\n  for (const propertyName of camelCasePropsAsStrings) {\n    Object.defineProperty(thisObj, propertyName, {\n      get: function() {\n        return this.getAttribute(convertCamelToDash(propertyName))\n      },\n      set: function(value) {\n        return value\n          ? this.setAttribute(convertCamelToDash(propertyName), value)\n          : this.removeAttribute(convertCamelToDash(propertyName))\n      },\n    })\n  }\n}\n\n/*\n * Short version is:\n *   <div\n *     contenteditable=\"true\"\n *     onInput=\"e => console.log('Text inside div', e.currentTarget.textContent)\"\n *   >\n *     Text inside div\n *   </div>\n */\n\nfunction makeElementEditableSanely(\n  element: HTMLElement,\n  callback?: (element: HTMLElement) => void\n) {\n  function makeEditable(event: Event) {\n    element.contentEditable = \"true\"\n    element.blur()\n    element.focus()\n    document.execCommand(\"selectAll\", false, undefined)\n    event.preventDefault()\n    event.stopPropagation()\n    const resetContentEditable = (event: Event) => {\n      element.contentEditable = \"false\"\n      element.removeEventListener(\"keydown\", handleKeyDown)\n      document.removeEventListener(\"click\", handleClickContentEditable)\n      if (typeof callback === \"function\") callback(element)\n    }\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.key === \"Tab\") {\n        resetContentEditable(event)\n      }\n    }\n    const handleClickContentEditable = (event: MouseEvent) => {\n      if (event.clientX === 0 && event.clientY === 0) {\n        event.preventDefault()\n        event.stopPropagation()\n      } else resetContentEditable(event)\n    }\n\n    element.addEventListener(\"keydown\", handleKeyDown)\n    document.addEventListener(\"click\", handleClickContentEditable)\n  }\n  element.addEventListener(\"dblclick\", makeEditable)\n  element.addEventListener(\"keydown\", event => {\n    if (event.key === \"Enter\") makeEditable(event)\n  })\n}\n\nfunction findElementInEventPath(\n  event: Event,\n  searchTag: string\n): HTMLElement | null {\n  function predicate(eventTarget: EventTarget, searchTag: string) {\n    if (eventTarget instanceof HTMLElement)\n      return eventTarget.tagName === searchTag\n    else return false\n  }\n  const foundElement = event\n    .composedPath()\n    .find((eventTarget: EventTarget): eventTarget is HTMLElement =>\n      predicate(eventTarget, searchTag)\n    )\n  return foundElement ? foundElement : null\n}\n\nfunction loadCss(path: string, target = document.head) {\n  return new Promise(function(resolve, reject) {\n    const link = document.createElement(\"link\")\n    link.rel = \"stylesheet\"\n    link.href = path\n    target.appendChild(link)\n    link.onload = () => resolve()\n  })\n}\n\nfunction changeCss(element: Element, cssMap: [string, string][]) {\n  if (element instanceof HTMLElement)\n    cssMap.forEach(\n      ([prop, value]: [any, string]) => (element.style[prop as any] = value)\n    )\n  else console.error(`element is not of type HTMLElement`)\n}\n"],"names":[],"mappings":"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"}